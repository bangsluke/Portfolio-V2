---
import ProjectCard from '../../../components/portfolio/ProjectCard.astro';
import Heading from '../../../components/ui/Heading.astro';
import { Icon } from 'astro-icon/components';
import { getCollection } from 'astro:content';

// Get all projects from the local content folder
const projects = await getCollection('projects');

// Sort projects by dateStart date (newest first)
const sortedProjects = projects.sort((a, b) => {
	// Sort by dateStart date, fallback to dateEnd date, then alphabetically
	const dateA = a.data.dateStart || a.data.dateEnd || new Date(0);
	const dateB = b.data.dateStart || b.data.dateEnd || new Date(0);

	if (dateA instanceof Date && dateB instanceof Date) {
		return dateB.getTime() - dateA.getTime();
	}

	// Fallback to alphabetical sorting by slug (filename)
	return a.slug.localeCompare(b.slug);
});
---
<html lang="en">
  <head>
    <title>All Projects | Portfolio</title>
    <meta name="description" content="View all projects in my portfolio" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  </head>
  <body class="bg-[#10151a] text-white min-h-screen">
    <main class="min-h-screen">
      <!-- Header Section -->
      <section class="py-8 px-8 max-md:py-4">
        <div class="max-w-7xl mx-auto">
          <div class="flex items-center gap-4 mb-8">
            <a href="/site#projects" class="text-mint-400 hover:text-mint-300 transition-colors duration-300 flex items-center gap-2">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
              </svg>
              Back to Portfolio
            </a>
          </div>
          
          <div class="flex gap-4 items-center justify-center mb-12">
            <Icon class="text-4xl text-mint-400" name="code" />
            <Heading text="" textGradient="All Projects" level={1} />
          </div>

          <p class="text-center mx-auto text-lg max-xl:text-base max-w-2xl text-gray-300 mb-12 leading-6 font-medium">
            Explore all my <b class="bg-linear-to-r from-riptide-500 to-mint-500 dark:from-riptide-300 dark:to-mint-200 text-transparent bg-clip-text">projects and developments</b>.
            Each one represents a unique challenge and learning experience.
          </p>
        </div>
      </section>

      <!-- Projects Grid Section -->
      <section class="py-8 px-8 max-md:py-4 mb-4">
        <div class="max-w-7xl mx-auto">
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
            {sortedProjects.map((project) => (
              <ProjectCard
                name={project.data.name ?? project.slug.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase())}
                imageURL={project.data.imageURL}
                technologies={project.data.technologies}
                shortDescription={project.data.shortDescription}
                slug={project.slug}
              />
            ))}
          </div>
          
          <div class="text-center mt-12 text-gray-400">
            <p>Showing {sortedProjects.length} projects</p>
          </div>
        </div>
      </section>
    </main>
  </body>
</html> 