---
import { processObsidianLink } from '../../utils/content-processor';

interface Props {
	name: string;
	linkedCompany?: string[];
	referenceRole?: string;
	referenceEmail?: string;
	referenceNumber?: string;
	referenceAddress?: string;
	companyLogoURL?: string | null;
}

const {
	name,
	linkedCompany,
	referenceRole,
	referenceEmail,
	referenceNumber,
	referenceAddress,
	companyLogoURL,
} = Astro.props;

// Process content to handle Obsidian links and markdown
const processedLinkedCompany = processObsidianLink(linkedCompany);

// console.log(name);
---

<div
	class="relative mx-12 pb-12 grid md:grid-cols-5 md:gap-10 before:absolute before:left-[-35px] before:block before:h-full before:border-l-2 before:border-black/20 dark:before:border-white/15 before:content-['']">
	<div class="pb-12 md:col-span-2">
		<div class="sticky top-0">
			<span
				class="absolute -left-[42px] text-5xl text-theme-400 rounded-full drop-shadow-[0px_0px_8px_rgba(0,255,94,1)]"
				>&bull;</span
			>
			<h3 class="text-xl font-bold text-theme-400">
				{name}
			</h3>
			{
				referenceRole && (
					<div class="mt-2">
						<span class="text-sm text-zinc-600 dark:text-white">Role: </span>
						<span class="text-sm text-theme-400">{referenceRole}</span>
					</div>
				)
			}
			{
				processedLinkedCompany && (
					<div class="mt-2">
						<span class="text-sm text-zinc-600 dark:text-white">Company: </span>
						<span class="text-sm text-theme-400">{processedLinkedCompany}</span>
					</div>
				)
			}
			{
				companyLogoURL && (
					<div class="mt-4">
						<img
							src={companyLogoURL}
							alt={`${name} company logo`}
							class="w-16 h-16 object-contain rounded-lg shadow-md"
						/>
					</div>
				)
			}
			{
				referenceEmail && (
					<div class="mt-2">
						<span class="text-sm text-zinc-600 dark:text-white">Email: </span>
						<a
							href={`mailto:${referenceEmail}`}
							class="text-sm text-theme-400 hover:text-theme-300 underline">
							{referenceEmail}
						</a>
					</div>
				)
			}
			{
				referenceNumber && (
					<div class="mt-2">
						<span class="text-sm text-zinc-600 dark:text-white">Phone: </span>
						<a
							href={`tel:${referenceNumber}`}
							class="text-sm text-theme-400 hover:text-theme-300 underline">
							{referenceNumber}
						</a>
					</div>
				)
			}
		</div>
	</div>
	<div
		class="flex flex-col gap-2 pb-4 text-zinc-00 dark:text-zinc-300 md:col-span-3">
		{
			referenceAddress && (
				<div class="processed-content" set:html={referenceAddress} />
			)
		}
	</div>
</div>
