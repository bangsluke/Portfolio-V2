---
import { processMarkdownContent } from '../../utils/content-processor';

interface Props {
  name: string;
  tags?: string[];
  dateStart?: string | Date | null;
  dateEnd?: string | Date | null;
  logoURL?: string | null;
  projectURL?: string | null;
  codeURL?: string | null;
  technologies?: string[];
  shortDescription?: string;
  longDescription?: string;
  lessonsLearned?: string;
}

const { name, tags, dateStart, dateEnd, logoURL, projectURL, codeURL, technologies, shortDescription, longDescription, lessonsLearned } = Astro.props;

// Process content to handle Obsidian links and markdown
const processedShortDescription = processMarkdownContent(shortDescription || '');
const processedLongDescription = processMarkdownContent(longDescription || '');
const processedLessonsLearned = processMarkdownContent(lessonsLearned || '');

console.log(name);
---

<div
  class="relative mx-12 pb-12 grid md:grid-cols-5 md:gap-10 before:absolute before:left-[-35px] before:block before:h-full before:border-l-2 before:border-black/20 dark:before:border-white/15 before:content-['']"
>
  <div class="pb-12 md:col-span-2">
    <div class="sticky top-0">
      <span
        class="absolute -left-[42px] text-5xl text-mint-400 rounded-full drop-shadow-[0px_0px_8px_rgba(0,255,94,1)]"
        >&bull;</span
      >
      <h3
        class="text-xl font-bold text-mint-400"
      >
        {name}
      </h3>
      <div class="text-sm text-zinc-600/80 dark:text-white/80">
        {dateStart?.toString()} - {dateEnd?.toString() || 'Present'}
      </div>
      {technologies && technologies.length > 0 && (
        <div class="mt-2">
          <span class="text-sm text-zinc-600 dark:text-white">Technologies: </span>
          <span class="text-sm text-mint-400">{technologies.join(', ')}</span>
        </div>
      )}
      {(projectURL || codeURL) && (
        <div class="mt-2 space-x-2">
          {projectURL && (
            <a href={projectURL} target="_blank" rel="noopener noreferrer" class="text-sm text-mint-400 hover:text-mint-300 underline">
              Live Demo
            </a>
          )}
          {codeURL && (
            <a href={codeURL} target="_blank" rel="noopener noreferrer" class="text-sm text-mint-400 hover:text-mint-300 underline">
              Code
            </a>
          )}
        </div>
      )}
    </div>
  </div>
  <div
    class="flex flex-col gap-2 pb-4 text-zinc-00 dark:text-zinc-300 md:col-span-3"
  >
    {processedShortDescription && (
      <div class="processed-content" set:html={processedShortDescription} />
    )}
    {processedLongDescription && (
      <div class="mt-4">
        <strong>Description:</strong>
        <div class="processed-content mt-2" set:html={processedLongDescription} />
      </div>
    )}
    {processedLessonsLearned && (
      <div class="mt-4">
        <strong>Lessons Learned:</strong>
        <div class="processed-content mt-2" set:html={processedLessonsLearned} />
      </div>
    )}
  </div>
</div> 