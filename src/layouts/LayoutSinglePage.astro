---
import '../styles/global.css';
import Header from '../components/layout/Header.astro';
import Footer from '../components/layout/Footer.astro';
import ScrollToTop from '../components/ui/ScrollToTop.astro';
import SpeedInsights from '@vercel/speed-insights/astro';
const {
	pageTitle = 'bangsluke Portfolio',
	description = 'Welcome to my portfolio site',
	ogimage = {
		url: '/images/imagedefault.webp',
		alt: 'Default image of bangsluke',
	},
} = Astro.props;

const siteUrl = new URL(Astro.url).origin;
const SEO = {
	sitename: 'bangsluke Portfolio',
	url: siteUrl,
	locale: 'en_UK',
	author: 'Luke Bangs | bangsluke',
	twitter: '@bangsluke',
};

const twitterimage = `${siteUrl}${ogimage.url}`;
---

<html
	lang="en"
	class="dark:bg-dark-background bg-theme-50/5 font-montserrat scroll-smooth">
	<head>
		<meta charset="UTF-8" />
		<meta
			name="viewport"
			content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no"
		/>
		<title>{pageTitle}</title>

		<!-- Prevent theme flash - apply theme immediately -->
		<script is:inline>
			// Apply theme immediately to prevent flash
			(function () {
				try {
					if (typeof window === 'undefined') return;

					// Check if user has already made a choice (stored in localStorage)
					if ('theme' in localStorage) {
						// User has made a choice before, use their stored preference
						document.documentElement.classList.toggle(
							'dark',
							localStorage.theme === 'dark'
						);
					} else {
						// First time visit - use OS preference but don't store it
						const prefersDark = window.matchMedia(
							'(prefers-color-scheme: dark)'
						).matches;
						document.documentElement.classList.toggle('dark', prefersDark);
					}
				} catch (error) {
					console.error('Theme flash prevention error:', error);
				}
			})();
		</script>

		<!-- Favicon for different platforms -->
		<link rel="icon" href="/favicon-32x32.png" sizes="32x32" />
		<link rel="icon" href="/favicon-16x16.png" sizes="16x16" />
		<link rel="apple-touch-icon" href="/apple-touch-icon.png" />
		<link rel="icon" href="/android-chrome-192x192.png" sizes="192x192" />
		<link rel="icon" href="/android-chrome-512x512.png" sizes="512x512" />

		<!-- Web manifest -->
		<link rel="manifest" href="/site.webmanifest" />

		<!-- Google Fonts -->
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap"
			rel="stylesheet"
		/>

		<meta name="description" content={description} />
		<meta name="author" content={SEO.author} />
		<meta name="robots" content="index, follow" />
		<link rel="canonical" href={`${Astro.site}${Astro.url.pathname}`} />
		<!-- Open Graph / Facebook -->
		<meta property="og:title" content={pageTitle} />
		<meta property="og:description" content={description} />
		<meta property="og:image" content={ogimage.url} />
		<meta property="og:image:alt" content={ogimage.alt} />
		<meta property="og:url" content={SEO.url} />
		<meta property="og:type" content="website" />
		<meta property="og:site_name" content={SEO.sitename} />
		<meta property="og:locale" content={SEO.locale} />

		<!-- Twitter Cards -->
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:title" content={pageTitle} />
		<meta name="twitter:description" content={description} />
		<meta name="twitter:image" content={twitterimage} />
		<meta name="twitter:image:alt" content={ogimage.alt} />
		<meta name="twitter:site" content={SEO.twitter} />

		<meta name="theme-color" content="#0E0E11" />

		<!-- Sitemap -->
		<link rel="sitemap" href="/sitemap-index.xml" />
	</head>
	<body class="overflow-x-hidden overflow-y-hidden">
		<SpeedInsights />
		<div class="blur-circle"></div>
		<div
			style="background: linear-gradient(45deg, var(--color-theme-500-rgba-001) 10.79%, var(--color-theme-500-rgba-003) 40.92%, var(--color-theme-500-rgba-001) 90.35%)"
			class="fixed top-0 left-0 w-full h-screen pointer-events-none -z-10">
		</div>
		<Header />

		<div class="h-[63vh] md:h-[72vh]">
			<slot />
		</div>

		<Footer />
		<ScrollToTop />
		<script>
			import '../scripts/menu.js';
		</script>
	</body>
</html>
