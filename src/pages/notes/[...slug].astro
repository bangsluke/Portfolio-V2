---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import { Image } from 'astro:assets';

// Generate static paths for all notes
export async function getStaticPaths() {
  const notes = await getCollection('obsidian');
  return notes.map((note) => ({
    params: { slug: note.slug },
    props: { note },
  }));
}

const { note } = Astro.props;
const { Content } = await note.render();
---

<Layout title={note.data.title}>
  <main class="container mx-auto px-4 py-8 max-w-4xl">
    <article class="prose prose-lg max-w-none">
      <!-- Breadcrumb -->
      <nav class="mb-8">
        <a href="/notes" class="text-blue-600 hover:text-blue-800">
          ← Back to Notes
        </a>
      </nav>

      <!-- Note Header -->
      <header class="mb-8 border-b pb-4">
        <h1 class="text-4xl font-bold mb-2">{note.data.title}</h1>
        <div class="flex items-center gap-4 text-gray-600 text-sm">
          <time datetime={note.data.date.toISOString()}>
            {note.data.date.toLocaleDateString()}
          </time>
          {note.data.tags && note.data.tags.length > 0 && (
            <div class="flex gap-2">
              {note.data.tags.map((tag) => (
                <span class="bg-gray-100 px-2 py-1 rounded text-xs">
                  {tag}
                </span>
              ))}
            </div>
          )}
        </div>
        {note.data.description && (
          <p class="text-gray-600 mt-2">{note.data.description}</p>
        )}
      </header>

      <!-- Note Content -->
      <div class="markdown-content">
        <Content />
      </div>

      <!-- Navigation -->
      <nav class="mt-12 pt-8 border-t">
        <div class="flex justify-between">
          <a href="/notes" class="text-blue-600 hover:text-blue-800">
            ← All Notes
          </a>
        </div>
      </nav>
    </article>
  </main>
</Layout>

<style>
  .markdown-content {
    @apply prose prose-lg max-w-none;
  }
  
  .markdown-content h1,
  .markdown-content h2,
  .markdown-content h3,
  .markdown-content h4,
  .markdown-content h5,
  .markdown-content h6 {
    @apply font-bold text-gray-900 mt-8 mb-4;
  }
  
  .markdown-content h1 { @apply text-3xl; }
  .markdown-content h2 { @apply text-2xl; }
  .markdown-content h3 { @apply text-xl; }
  
  .markdown-content p {
    @apply mb-4 text-gray-700 leading-relaxed;
  }
  
  .markdown-content ul,
  .markdown-content ol {
    @apply mb-4 pl-6;
  }
  
  .markdown-content li {
    @apply mb-2;
  }
  
  .markdown-content blockquote {
    @apply border-l-4 border-blue-500 pl-4 italic text-gray-600 my-4;
  }
  
  .markdown-content code {
    @apply bg-gray-100 px-2 py-1 rounded text-sm font-mono;
  }
  
  .markdown-content pre {
    @apply bg-gray-900 text-white p-4 rounded-lg overflow-x-auto my-4;
  }
  
  .markdown-content pre code {
    @apply bg-transparent p-0 text-white;
  }
  
  .markdown-content a {
    @apply text-blue-600 hover:text-blue-800 underline;
  }
  
  .markdown-content img {
    @apply max-w-full h-auto rounded-lg shadow-md my-4;
  }
  
  .markdown-content table {
    @apply w-full border-collapse border border-gray-300 my-4;
  }
  
  .markdown-content th,
  .markdown-content td {
    @apply border border-gray-300 px-4 py-2 text-left;
  }
  
  .markdown-content th {
    @apply bg-gray-100 font-semibold;
  }
</style> 